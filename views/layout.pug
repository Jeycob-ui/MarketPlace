html
  head
    meta(charset='utf-8')
    meta(name='viewport' content='width=device-width,initial-scale=1')
    title MarketPlace
    link(rel='stylesheet' href='/styles.css')
    link(rel='stylesheet' href='/profile.css')
    block styles
  body
    header
      nav
        a.logo(href='/') 
          img(src="/img/MarketPlace.jpeg", alt="MarketPlace Logo")
        a(href='/') Inicio
        a(href='/products') Productos
        if !currentUser
          a(href='/register') Registrar
          a(href='/login') Login
        else
          span Hola #{currentUser.name} (#{currentUser.role})
          a(href='/profile') Mi Perfil
          a(href='/cart') Carrito
          if currentUser && (currentUser.role === 'admin' || currentUser.role === 'vendedor')
            a(href='/notifications') Notificaciones
          if currentUser.role === 'admin'
            a(href='/admin') Usuarios
            a(href='/admin/products') Productos
            a(href='/admin/orders') Pedidos
          a(href='/logout') Salir
    main
      if messages.error
        .flash.error
          each m in messages.error
            div= m
      if messages.success
        .flash.success
          each m in messages.success
            div= m
      block content
    // Handler for unauthenticated add-to-cart buttons: set flash and redirect back
    script.
      document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('.btn-need-login').forEach(function (btn) {
          btn.addEventListener('click', function (e) {
            e.preventDefault();
            var next = window.location.pathname + window.location.search;
            window.location = '/notify-login?next=' + encodeURIComponent(next);
          });
        });
      });
    footer
      p Â© 2025 MarketPlace. Todos los derechos reservados.
