html
  head
    meta(charset='utf-8')
    meta(name='viewport' content='width=device-width,initial-scale=1')
    title MarketPlace
    link(rel='stylesheet' href='/styles.css')
    block styles
  body
    header
      nav
        a.logo(href='/') 
          img(src="/img/MarketPlace.jpeg", alt="MarketPlace Logo")
        button#hamburger.hamburger
          span
          span
          span
        .nav-links
          a(href='/') Inicio
          a(href='/products') Productos
          if !currentUser
            a(href='/register') Registrar
            a(href='/login') Login
          else
            .nav-right
              span.user-info Hola #{currentUser.name} (#{currentUser.role})
              a(href='/profile') Mi Perfil
              a(href='/cart') Carrito
              if currentUser && (currentUser.role === 'admin' || currentUser.role === 'vendedor')
                a(href='/notifications') Notificaciones
              if currentUser && currentUser.role === 'comprador'
                a(href='/notifications') Mis compras
              if currentUser.role === 'admin'
                a(href='/admin') Usuarios
                a(href='/admin/products') Productos
                a(href='/admin/orders') Pedidos
              a(href='/logout') Salir
    main
      if messages.error
        .flash.error
          each m in messages.error
            div= m
      if messages.success
        .flash.success
          each m in messages.success
            div= m
      block content
    // Handler for unauthenticated add-to-cart buttons: set flash and redirect back
    script.
      document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('.btn-need-login').forEach(function (btn) {
          btn.addEventListener('click', function (e) {
            e.preventDefault();
            var next = window.location.pathname + window.location.search;
            window.location = '/notify-login?next=' + encodeURIComponent(next);
          });
        });
        
        // Hamburger menu toggle
        var hamburger = document.getElementById('hamburger');
        var navLinks = document.querySelector('.nav-links');
        var body = document.body;
        
        if (hamburger) {
          hamburger.addEventListener('click', function () {
            navLinks.classList.toggle('active');
            hamburger.classList.toggle('active');
            body.classList.toggle('menu-open');
          });
          
          // Close menu when clicking outside
          document.addEventListener('click', function (e) {
            if (!hamburger.contains(e.target) && !navLinks.contains(e.target)) {
              navLinks.classList.remove('active');
              hamburger.classList.remove('active');
              body.classList.remove('menu-open');
            }
          });
        }
      });
    footer
      p &copy; 2024 MarketPlace. Todos los derechos reservados.